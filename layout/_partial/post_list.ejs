<% let posts_to_display = locals.posts || page.posts %>
<% let toggle_show_paginator = locals.show_paginator == false ? false : true %>
<% if (toggle_show_paginator) { %>
<%- partial('_partial/paginator') %>
<% } %>
<% posts_to_display.filter( post => !(post.hidden)).sort('updated', 'desc').each(function(post, i){ %>
<div class="box">
    <div class="field is-grouped is-grouped-multiline">
        <div class="control">
            <% post.tags.each(function (tag, j) { %>
            <a href="<%- url_for(`tags/${tag.name}`) %>">
                <span class="tag is-link">#<%= tag.name %></span>
            </a>
            <% }) %>
            <% if (post.oneof) { %>
            <%- partial('_partial/series_tag', {name: post.oneof}) %>
            <% } %>
        </div>
    </div>
    <a href="<%- url_for(post.path) %>">
        <h2 class="title is-4"><%= post.title %></h2>
    </a>
    <% if (post.excerpt) { %>
    <div class="mx-1 my-3"><%- post.excerpt %></div>
    <% } %>
    <div class="my-3 has-text-grey-dark">
        <span>Created: <time datetime="<%= date_xml(post.date) %>"
                itemprop="dateModified"><%= date(post.date, config.date_format) %></time></span>,
        <span>Last update: <time datetime="<%= date_xml(post.updated) %>"
                itemprop="dateModified"><%= date(post.updated, config.date_format) %></time></span>
        <span class="is-pulled-right is-hidden-mobile">
            <%- partial('_partial/word_count', {post}) %>
        </span>
    </div>
</div>
<% }); %>
<% if (toggle_show_paginator) { %>
<%- partial('_partial/paginator') %>
<% } %>